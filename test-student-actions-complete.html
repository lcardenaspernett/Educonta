<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba Completa - Acciones de Estudiantes</title>
    <link rel="stylesheet" href="public/css/accounting-dashboard.css">
    <link rel="stylesheet" href="public/css/students-improved.css">
    <link rel="stylesheet" href="public/css/student-modals.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #f8fafc;
            margin: 0;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .test-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        .test-header h1 {
            color: #1e293b;
            margin: 0 0 10px 0;
            font-size: 28px;
        }
        .test-header p {
            color: #64748b;
            margin: 0;
            font-size: 16px;
        }
        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .student-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s ease;
        }
        .student-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        .student-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .student-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 18px;
        }
        .student-info h3 {
            margin: 0 0 5px 0;
            color: #1e293b;
            font-size: 18px;
        }
        .student-info p {
            margin: 0;
            color: #64748b;
            font-size: 14px;
        }
        .student-details {
            margin-bottom: 20px;
        }
        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }
        .detail-label {
            color: #6b7280;
            font-weight: 500;
        }
        .detail-value {
            color: #1f2937;
            font-weight: 600;
        }
        .student-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .action-btn {
            flex: 1;
            min-width: 70px;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        .action-btn.view {
            background: #dbeafe;
            color: #1e40af;
        }
        .action-btn.view:hover {
            background: #bfdbfe;
            transform: translateY(-1px);
        }
        .action-btn.edit {
            background: #fef3c7;
            color: #92400e;
        }
        .action-btn.edit:hover {
            background: #fde68a;
            transform: translateY(-1px);
        }
        .action-btn.events {
            background: #d1fae5;
            color: #065f46;
        }
        .action-btn.events:hover {
            background: #a7f3d0;
            transform: translateY(-1px);
        }
        .action-btn.account {
            background: #e0e7ff;
            color: #3730a3;
        }
        .action-btn.account:hover {
            background: #c7d2fe;
            transform: translateY(-1px);
        }
        .test-info {
            background: #f0f9ff;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .test-info h3 {
            margin: 0 0 10px 0;
            color: #0c4a6e;
        }
        .test-info ul {
            margin: 0;
            padding-left: 20px;
            color: #0369a1;
        }
        .test-info li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>🎯 Prueba Completa - Acciones de Estudiantes</h1>
            <p>Sistema completo de gestión con modales interactivos</p>
        </div>

        <div class="test-info">
            <h3>📋 Funcionalidades Disponibles:</h3>
            <ul>
                <li><strong>Ver Detalles:</strong> Modal con información completa del estudiante</li>
                <li><strong>Editar:</strong> Formulario completo con cursos dinámicos</li>
                <li><strong>Eventos:</strong> Gestión de eventos asignados y disponibles</li>
                <li><strong>Estado de Cuenta:</strong> Pagos, deudas y movimientos</li>
                <li><strong>Procesamiento de Pagos:</strong> Sistema completo de registro de pagos</li>
            </ul>
        </div>

        <div class="students-grid" id="studentsGrid">
            <!-- Se llenará dinámicamente -->
        </div>
    </div>

    <!-- Scripts -->
    <script src="public/js/students-data.js"></script>
    <script src="public/js/filter-config.js"></script>
    <script src="public/js/accounting/student-actions.js"></script>
    
    <script>
        // Simular datos de estudiantes para la prueba
        const testStudents = [
            {
                id: '1',
                firstName: 'María Alejandra',
                lastName: 'González López',
                fullName: 'María Alejandra González López',
                documentType: 'TI',
                document: '1234567890',
                email: 'maria.gonzalez@villasanpablo.edu.co',
                phone: '+57 300 123 4567',
                grade: '10',
                course: '02',
                status: 'ACTIVE',
                address: 'Calle 123 #45-67, Bogotá',
                guardian: {
                    name: 'Carlos González',
                    phone: '+57 301 234 5678',
                    email: 'carlos.gonzalez@email.com'
                },
                events: [
                    {
                        eventId: 'event1',
                        eventName: 'Derecho de Grado',
                        amount: 150000,
                        paid: 75000,
                        status: 'PARTIAL',
                        paymentDate: null
                    },
                    {
                        eventId: 'event2',
                        eventName: 'Rifa Navideña',
                        amount: 50000,
                        paid: 50000,
                        status: 'PAID',
                        paymentDate: new Date('2025-01-15').toISOString()
                    }
                ],
                totalDebt: 75000,
                totalPaid: 125000
            },
            {
                id: '2',
                firstName: 'Juan Carlos',
                lastName: 'Pérez García',
                fullName: 'Juan Carlos Pérez García',
                documentType: 'TI',
                document: '2345678901',
                email: 'juan.perez@villasanpablo.edu.co',
                phone: '+57 302 345 6789',
                grade: '11',
                course: '01',
                status: 'ACTIVE',
                address: 'Carrera 45 #12-34, Medellín',
                guardian: {
                    name: 'María García',
                    phone: '+57 303 456 7890',
                    email: 'maria.garcia@email.com'
                },
                events: [
                    {
                        eventId: 'event3',
                        eventName: 'Bingo Familiar',
                        amount: 30000,
                        paid: 0,
                        status: 'PENDING',
                        paymentDate: null
                    }
                ],
                totalDebt: 30000,
                totalPaid: 0
            },
            {
                id: '3',
                firstName: 'Ana Sofía',
                lastName: 'Martínez Ruiz',
                fullName: 'Ana Sofía Martínez Ruiz',
                documentType: 'TI',
                document: '3456789012',
                email: 'ana.martinez@villasanpablo.edu.co',
                phone: '+57 304 567 8901',
                grade: '9',
                course: '03',
                status: 'ACTIVE',
                address: 'Avenida 80 #25-30, Cali',
                guardian: {
                    name: 'Luis Martínez',
                    phone: '+57 305 678 9012',
                    email: 'luis.martinez@email.com'
                },
                events: [],
                totalDebt: 0,
                totalPaid: 0
            }
        ];

        function init() {
            console.log('🚀 Inicializando prueba de acciones...');
            
            // Simular datos globales
            window.studentsPage = {
                students: testStudents,
                renderStudents: function() {
                    console.log('🔄 Simulando actualización de tabla');
                }
            };
            
            renderTestStudents();
        }

        function renderTestStudents() {
            const container = document.getElementById('studentsGrid');
            
            const html = testStudents.map(student => {
                const eventsCount = student.events ? student.events.length : 0;
                const debtStatus = student.totalDebt > 0 ? 'Con deuda' : 'Al día';
                const debtClass = student.totalDebt > 0 ? 'amount-negative' : 'amount-positive';
                
                return `
                    <div class="student-card">
                        <div class="student-header">
                            <div class="student-avatar">${student.firstName.charAt(0)}${student.lastName.charAt(0)}</div>
                            <div class="student-info">
                                <h3>${student.fullName}</h3>
                                <p>${student.grade}° - Curso ${student.course}</p>
                            </div>
                        </div>
                        
                        <div class="student-details">
                            <div class="detail-row">
                                <span class="detail-label">Documento:</span>
                                <span class="detail-value">${student.documentType}: ${student.document}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Email:</span>
                                <span class="detail-value">${student.email}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Eventos:</span>
                                <span class="detail-value">${eventsCount} asignados</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Estado:</span>
                                <span class="detail-value ${debtClass}">${debtStatus}</span>
                            </div>
                            <div class="detail-row">
                                <span class="detail-label">Deuda:</span>
                                <span class="detail-value ${debtClass}">$${(student.totalDebt || 0).toLocaleString()}</span>
                            </div>
                        </div>
                        
                        <div class="student-actions">
                            <button class="action-btn view" onclick="viewStudent('${student.id}')" title="Ver detalles">
                                👁️ Ver
                            </button>
                            <button class="action-btn edit" onclick="editStudent('${student.id}')" title="Editar">
                                ✏️ Editar
                            </button>
                            <button class="action-btn events" onclick="viewStudentEvents('${student.id}')" title="Ver eventos">
                                📅 Eventos
                            </button>
                            <button class="action-btn account" onclick="viewStudentAccount('${student.id}')" title="Estado de cuenta">
                                💰 Cuenta
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            console.log('✅ Estudiantes de prueba renderizados');
        }

        // Inicializar cuando se cargue la página
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>